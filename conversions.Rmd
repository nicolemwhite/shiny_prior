---
title: "Conversions from R to Stata, TreeAge"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(flextable)

```

***Parameterisation for random number generation used in R, Stata, MS Excel and TreeAge Pro***
```{r}
convtable<-tibble(
  Distribution = c("Normal\nN(\u3bc,\u3c3)","Gamma\nG(\u3b1,\u3b2)","Log-Normal\nLN(\u3bc,\u3c3)","Weibull\nWeib(\u3bb,\u006b)","Beta\nBeta(\u3b1,\u3b2)","Uniform\nU(\u0061,\u0062)"),
  `R parameters` = c("mean = \u3bc\nsd = \u3c3\nrnorm(n,mean,sd)",
                     "shape = \u3b1\nrate = \u3b2\nrgamma(n,shape,rate)",
                     "meanlog = \u3bc\nsdlog = \u3c3\nrlnorm(n,meanlog,sdlog)",
                     "shape = \u3bb\nscale = \u006b\nrweibull(n,shape,scale)",
                     "shape1 = \u3b1\nshape2 = \u3b2\nrbeta(n,shape1,shape2)",
                     "min = a\nmax = b\nrunif(n,min,max)"),
  `Stata parameters` = c("m = \u3bc\ns = \u3c3\nrnormal(m,s)",
                         "a = \u3b1\nb = 1/\u3b2\nrgamma(a,b)",
                         "m = \u3bc\ns = \u3c3\nexp(rnormal(m,s))",
                         "a = \u3bb\nb = \u006b\nrweibull(a,b)",
                         "a = \u3b1\nb = \u3b2\nrbeta(a,b)",
                         "a = \u0061\nb = \u0062\nruniform(a,b)"),
  `MS Excel parameters` = c("mean = \u3bc\nstandard_dev = \u3c3\n=NORM.INV(RAND(),mean,standard_dev)",
                            "alpha = \u3b1\nbeta = \u3b2\n=GAMMA.INV(RAND(),alpha,beta)",
                            "mean = \u3bc\nstandard_dev = \u3c3\n=LOGNORM.INV(RAND(),mean,standard_dev)",
                            "shape = x\nscale = y\n=y(-LN(1-RAND()))^(1/x)",
                            "alpha = \u3b1\nbeta = \u3b2\n=BETA.INV(RAND(),alpha,beta)",
                            "bottom = a\ntop = b\n=RANDBETWEEN(bottom,top)"),
  `TreeAge Pro parameters` = c("Mean = \u3bc\nStandard deviation = \u3c3",
                               "\u3b1 = \u3b1\n\u3bb = 1/\u3b2",
                               "\u3bc = \u3bc\n\u3c3 = \u3c3",
                               "\u3bb = \u1d4f\n\u006b",
                               "a = \u3b1\nb = \u3b2",
                               "LB = a\nUB = b"))


show_convtable = flextable(convtable) %>% 
  merge_v(j=c("Distribution","R parameters","Stata parameters","MS Excel parameters","TreeAge Pro parameters")) %>% theme_box %>% width(width=c(1.75,2,2,2,2))
htmltools_value(show_convtable)

```
